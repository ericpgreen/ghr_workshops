---
title: "Causal Inference Workshop"
subtitle: "Eldoret, June 2023"
author:
  - Eric Green
format: 
  revealjs:
    multiplex: true
    theme: [custom.scss]
    slide-number: c/t
    incremental: true
    progress: true
    title-slide-attributes:
      data-background-image: img/title.png
      data-background-size: contain
      data-background-opacity: "1"
---

```{r, include=FALSE}
library(countdown)
```

##  {background-image="img/FallMini2022-11.jpg"}

## Today's Agenda

::: columns
::: {.column width="90%"}
| Time        | Topic                             |
|-------------|:----------------------------------|
| 10:00-11:00 | The challenge of causal inference |
| 10:00-11:15 | ‚òïÔ∏è Coffee/tea break               |
| 11:15-12:00 | DAGs                              |

:::
:::


## Thursday and Friday ü§ù

Available for 1-on-1s or small group consultation. Sign-up for a slot at [ghr.link/meeting-eld23](https://ghr.link/meeting-eld23)

![](img/QR_meeting.png)

##  {background-image="img/coffee.png"}

## Observational Findings

[Ding et al. (2015)](https://www.ahajournals.org/doi/10.1161/CIRCULATIONAHA.115.017341) conducted a pooled analysis of three large prospective cohort studies of health professionals in the U.S. (95% white) followed for up to 36 years:

> Higher consumption of total coffee, caffeinated coffee, and decaffeinated coffee was associated with lower risk of total mortality‚Ä¶Relative to no consumption of coffee, the pooled hazard ratio for death was 0.95 (95% confidence interval [CI], 0.91‚Äì0.99) for 1.0 or less cup of total coffee per day.

In other words, the sort of people who drink a cup of coffee daily have a 5% lower risk of dying over 2 to 3 decades. 

## Causal Deniability

Does this mean that coffee prevents death? The study authors say no. But also, maybe!

**Step 1: Avoid the word ‚Äúcausal‚Äù and warn that correlation is not causation.**

> ‚Ä¶given the observational nature of the study design, we could not directly establish a cause-effect relationship between coffee and mortality.

## Causal Deniability

Does this mean that coffee prevents death? The study authors say no. But also, maybe!

[Step 1: Avoid the word ‚Äúcausal‚Äù and warn that correlation is not causation.]{style="color:rgba(178, 190, 181);"}

**Step 2: Ignore the warning and make policy or health recommendations based on a causal interpretation of the findings.**

> ‚Ä¶coffee consumption can be incorporated into a healthy lifestyle‚Ä¶moderate consumption of coffee may confer health benefits in terms of reducing premature death.

## So which is it, a non-causal association or a causal effect? 

[Hern√°n (2018)](https://ajph.aphapublications.org/doi/full/10.2105/AJPH.2018.304337) argues that scientists need to stop the charade:

> We need to stop treating "causal" as a dirty word that respectable investigators do not say in public or put in print. It is true that observational studies cannot definitely prove causation, but this statement misses the point‚Ä¶

According to Hern√°n, the point is that we have to be clear about our scientific goals and use language that reflects these goals. 

## What is our goal? What do we want to know?
<br>

[A. Whether the sort of people who drink a cup of coffee daily have a lower risk of dying]{style="font-size:150%;"}

[B. Whether drinking a cup of coffee daily lowers the risk of dying?]{style="font-size:150%;"}

## What is our goal? What do we want to know?
<br>

[A. Whether the sort of people who drink a cup of coffee daily have a lower risk of dying]{style="font-size:150%; color:rgba(178, 190, 181);"}

[B. Whether drinking a cup of coffee daily lowers the risk of dying?]{style="font-size:150%; background-color:rgba(244, 186, 2);"}

## To answer this question we need causal inference
<br>

[A. Whether the sort of people who drink a cup of coffee daily have a lower risk of dying]{style="font-size:150%; color:rgba(178, 190, 181);"}

[B. Whether drinking a cup of coffee daily lowers the risk of dying?]{style="font-size:150%; background-color:rgba(244, 186, 2);"}


# [Causal Inference]{style="color:white; font-size:200%;"} {background="linear-gradient(0deg, #00529b, #1f9ac9)"}

## Causal Inference

Causal inference is what we do when we identify and estimate the causal effect of some proposed cause on an outcome of interest.

<center>
![](img/causeeffect.png)
</center>

## Counterfactual Thinking

[Causal inference is an exercise in counterfactual thinking, full of "what if" questions about the road not taken.]{style="font-size:150%; background-color:rgba(244, 186, 2);"}

A counterfactual is the hypothetical state of a "what if" question. With counterfactual thinking, there is what actually happened, and then there is the hypothetical counterfactual of what would have happened, counter to fact, under the alternative scenario. The difference between what did happen and what would have happened is a known as the causal effect.

## {background-image="img/road less traveled 0.svg"}
## {background-image="img/road less traveled 1.svg"}
## {background-image="img/road less traveled 2.svg"}
## {background-image="img/road less traveled 3.svg"}

## Avererage Treatment Effects

We can't measure the causal impact of road choice for Robert as an individual (because we only observe one potential outcome), but we can compare groups of people like Robert who take one road or the other and estimate the average treatment effect, or ATE. 

To see why this works, let's *pretend* that we know everyone's potential outcomes. 

## {background-image="img/po.png"}

## Back to Reality

We're not all knowing, of course, and we only get to observe one potential outcome for each person. This means we have to estimate the ATE by comparing people like Robert who take the road less traveled to people who take the road more traveled. But how do people come to take one road versus the other?

## {background-image="img/po2.png"}

## Randomization Neutralizes Selection Bias...

Under perfect randomization, the estimated ATE 1.5 is equal to the true (but unknowable) ATE. But when travelers selected their own road, the estimate is 4.7. This does not line up with the true ATE because the estimate includes bias.

## ...But Randomization is Not Always Possible or Maintained

Most research is non-experimental, or what many would call observational. Selection bias will always be with us. Our only defense against being fooled by selection bias is research design and statistical adjustment. As [Cunningham (2020)](https://mixtape.scunning.com/) states:

> One could argue that the entire enterprise of causal inference is about developing a reasonable strategy for negating the role that selection bias is playing in estimated causal effects.

## Causal Inference Methods

[Matthay et al. (2020)](https://pubmed.ncbi.nlm.nih.gov/31890846/) divide non-experimental approaches to causal inference into two main buckets: confounder-control and instrument-based.[^others] 

**Confounder-control** is characterized by the use of statistical adjustment to make groups more comparable.

**Instrument-based studies**, sometimes called **quasi-experimental designs**, estimate treatment effects by finding and leveraging arbitrary reasons why some people are more likely to be treated or exposed.

[^others]: You might also come across references to Bradford Hill's Considerations and the sufficient-component cause model.

# [Causal Inference Methods]{style="color:white; font-size:200%;"} {background="linear-gradient(0deg, #00529b, #1f9ac9)"}
